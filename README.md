# USB 文件监控系统项目说明

## 项目概述
本项目是一个基于 Electron 的 USB 文件监控系统，旨在监控移动磁盘的状态以及文件的变更情况。用户可以通过登录系统，查看移动磁盘的状态信息和文件变更记录，并可以对文件变更记录进行过滤和分页查看。

## 项目结构
```
src/
├── index.html          # 主页面 HTML 文件
├── index.js            # 主进程逻辑文件
├── index.css           # 主页面样式文件
├── renderer.js         # 渲染进程逻辑文件
├── preload.js          # 预加载脚本文件
├── login.html          # 登录页面 HTML 文件
├── renderer/
│   └── file-changes.html # 文件变更记录页面 HTML 文件
```

## 功能模块

### 1. 登录模块
- **文件**：`src/login.html`、`src/login.js`
- **描述**：用户可以输入账号和密码进行登录。如果用户不存在，系统会自动创建新用户并登录。登录成功后，用户将跳转到主页面。

### 2. 主页面模块
- **文件**：`src/index.html`、`src/index.js`、`src/index.css`、`src/renderer.js`
- **描述**：主页面显示移动磁盘的状态和文件变更监控信息。用户可以通过点击标题栏的按钮对窗口进行最小化、最大化和关闭操作。页面会实时显示部分移动磁盘状态和文件变更记录，当记录数量超过一定数量时，会显示“查看更多”按钮，点击后会弹出模态框显示全部记录。

### 3. 文件变更记录模块
- **文件**：`src/renderer/file-changes.html`
- **描述**：该页面提供了文件变更记录的查看功能。用户可以通过输入文件名、选择变更类型、设置日期范围等条件对记录进行过滤，还可以通过分页按钮查看不同页面的记录。

## 代码详细说明

### 主进程逻辑（`src/index.js`）
- **获取可移动磁盘路径**：通过执行 PowerShell 脚本获取可移动磁盘的路径，并将移动磁盘信息发送到渲染进程进行渲染。
- **监控文件变化**：使用 `chokidar` 库对移动磁盘上的文件进行监控，当文件发生变更时，将变更信息记录下来。

### 渲染进程逻辑（`src/renderer.js`）
- **处理窗口操作**：监听标题栏按钮的点击事件，向主进程发送窗口最小化、最大化和关闭的请求。
- **显示移动磁盘状态和文件变更记录**：监听主进程发送的移动磁盘状态数据和文件变更记录数据，并将其显示在页面上。
- **切换 USB 状态**：提供切换 USB 启用/禁用状态的功能，并将操作结果显示在页面上。

### 预加载脚本（`src/preload.js`）
- **暴露 IPC 方法**：通过 `contextBridge` 暴露 `ipcRenderer` 的 `send`、`on` 和 `invoke` 方法，使渲染进程可以安全地与主进程进行通信。

## 运行步骤
1. 确保已经安装了 Node.js 和 npm。
2. 克隆项目到本地：
```bash
git clone <项目仓库地址>
cd <项目目录>
```
3. 安装依赖：
```bash
npm install
```
4. 启动项目：
```bash
npm start
```

## 注意事项
- 项目使用了 MongoDB 作为数据库，需要确保本地 MongoDB 服务已启动，并且数据库配置信息（`src/main.js` 中的 `mongoConfig`）正确。
- 由于使用了 PowerShell 脚本获取可移动磁盘路径，该项目仅支持 Windows 系统。