<!--
 * @Author: 周克朋 15538308935@163.com
 * @Date: 2025-07-09 11:10:27
 * @LastEditors: 周克朋 15538308935@163.com
 * @LastEditTime: 2025-07-10 17:18:07
 * @FilePath: \usbManger\usb-file-monitor\README.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# USB文件监控系统文档

## 一、系统概述
本系统是一个基于Electron构建的桌面应用程序，主要用于监控移动磁盘的插拔状态以及文件变更情况。系统具备用户登录、MongoDB配置管理、磁盘状态实时监测、文件变更记录展示等功能，为用户提供了便捷的移动磁盘管理和文件监控解决方案。

## 二、系统架构
### 1. 整体架构
本系统采用主进程与渲染进程分离的架构模式，主进程负责系统的核心逻辑处理，如窗口管理、数据库连接、磁盘检测等；渲染进程负责用户界面的展示和交互，如登录界面、主界面、MongoDB设置界面等。

### 2. 主要模块
- **登录模块**：负责用户的登录验证，支持自动创建新用户。
- **MongoDB配置模块**：允许用户配置和保存MongoDB的连接信息。
- **磁盘检测模块**：定时检测移动磁盘的插拔状态，并将状态信息发送到渲染进程进行展示。
- **文件监控模块**：监控移动磁盘上的文件变更情况，并将变更记录保存到MongoDB中。
- **界面展示模块**：提供用户界面，展示移动磁盘状态和文件变更记录。

## 三、功能介绍
### 1. 用户登录
用户可以通过输入用户名和密码进行登录。如果用户不存在，系统将自动创建新用户并完成登录。

### 2. MongoDB配置
用户可以在系统中配置MongoDB的连接信息，包括数据库链接URL和数据库名称。配置信息将保存到本地磁盘，方便下次使用。

### 3. 移动磁盘状态监测
系统会定时检测移动磁盘的插拔状态，并在主界面展示移动磁盘的名称和状态。如果状态信息较多，用户可以点击“查看更多”按钮查看全部信息。

### 4. 文件变更监控
系统会监控移动磁盘上的文件变更情况，包括文件的新增、修改和删除。变更记录将在主界面展示，用户可以通过过滤器筛选特定的变更记录。

### 5. 分页功能
文件变更记录支持分页展示，用户可以通过点击“首页”、“上一页”、“下一页”等按钮进行翻页操作。

## 四、代码结构
### 1. 主进程文件
- `main.js`：负责系统的初始化和主进程的核心逻辑处理，包括窗口创建、登录验证、MongoDB配置管理等。
- `index.js`：负责磁盘检测和文件监控的核心逻辑处理，包括定时检测磁盘插拔、获取可移动磁盘路径、监控文件变更等。

### 2. 渲染进程文件
- `index.html`：系统的主界面，展示移动磁盘状态和文件变更记录。
- `file-changes.html`：文件变更记录的详细展示页面，支持过滤器和分页功能。
- `mongo-settings.html`：MongoDB配置界面，允许用户配置和保存MongoDB的连接信息。
- `login.html`：用户登录界面，提供用户名和密码输入框以及登录按钮。

### 3. 工具文件
- `util/index.js`：提供日志记录工具，用于记录系统的运行信息和错误信息。

## 五、安装与运行
### 1. 安装依赖
在项目根目录下执行以下命令安装项目依赖：
```bash
npm install
```

### 2. 运行项目
安装完成后，执行以下命令启动项目：
```bash
npm start
```

### 3. 打包项目
如果需要将项目打包成可执行文件，可以使用以下命令：
```bash
npm run package
```
打包完成后，可在`dist`目录下找到生成的可执行文件。

## 六、注意事项
- 本系统依赖MongoDB数据库，请确保MongoDB服务已启动，并且配置信息正确。
- 磁盘检测和文件监控功能需要在Windows系统上运行，因为使用了PowerShell脚本获取磁盘信息。
- 日志记录使用GBK编码输出，确保终端支持GBK编码，以免出现乱码问题。